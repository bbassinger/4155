from unittest import TestCase
from app.twitch_rec.live_stream_info import LiveStreams
from datetime import datetime as datetime
from dateutil.parser import parse as dt_parse
from pytz import utc
from datetime import timedelta


class TestLiveStreams(TestCase):
    full_test_list = [{'id': '3018333969468093515', 'user_id': '15564828', 'user_name': 'NICKMERCS', 'game_id': '512710', 'type': 'live', 'title': "Season 5 Fraggin' | @NICKMERCS", 'viewer_count': 59337, 'started_at': '2020-08-05T16:09:17Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_nickmercs-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '2hr 33min'}, {'id': '2385007985', 'user_id': '36769016', 'user_name': 'TimTheTatman', 'game_id': '512710', 'type': 'live', 'title': '$100,000 tournament RIGHT NOW! - !youtube2', 'viewer_count': 40553, 'started_at': '2020-08-05T12:10:42Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_timthetatman-{width}x{height}.jpg', 'tag_ids': ['e6bb8b34-4c28-4b5f-94ed-12c1ebf2d0e4', '6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '6hr 32min'}, {'id': '2385620657', 'user_id': '23161357', 'user_name': 'LIRIK', 'game_id': '512980', 'type': 'live', 'title': '100 gifted subs a win ', 'viewer_count': 32682, 'started_at': '2020-08-05T16:08:24Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_lirik-{width}x{height}.jpg', 'tag_ids': ['c2839af5-f1d2-46c4-8edc-1d0bfbd85070', '6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '2hr 34min'}, {'id': '2384980865', 'user_id': '26610234', 'user_name': 'CohhCarnage', 'game_id': '512980', 'type': 'live', 'title': 'FALL GUYS  \\o/ - Horizon: Zero Dawn TOMORROW at 8am ET!! - !Coffee - !Discord - !Corsair', 'viewer_count': 16623, 'started_at': '2020-08-05T11:50:22Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_cohhcarnage-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '96b6073f-450d-4248-8ed4-988e28f3f759', 'eaba0ad7-c4e1-4878-b37f-01308dbb65c8', '2a14b52e-d459-4c92-be11-5d86b898f6b6'], 'stream_duration': '6hr 52min'}, {'id': '2705962128844326087', 'user_id': '71092938', 'user_name': 'xQcOW', 'game_id': '509658', 'type': 'live', 'title': 'BEST GAMER TO WALK THE EARTH GOES LIVE WOW.', 'viewer_count': 16125, 'started_at': '2020-08-05T18:28:12Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_xqcow-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 14min'}, {'id': '7464334279688565453', 'user_id': '56649026', 'user_name': 'Quin69', 'game_id': '27471', 'type': 'live', 'title': 'HC MINECRAFT "BLIND" - DRAGON FIGHT ROUND 2 - RIP = 300 SUBS - THIS IT THE RUN -  !rip31 - past !RIPS ', 'viewer_count': 10947, 'started_at': '2020-08-05T14:03:02Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_quin69-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', 'd24d8407-b69f-466b-a059-b43ddacd3e7c', 'c9193f35-a88f-4f03-af99-b73fe0db60f3'], 'stream_duration': '4hr 39min'}, {'id': '4142412125644281573', 'user_id': '60056333', 'user_name': 'Tfue', 'game_id': '512710', 'type': 'live', 'title': '$100,000 Tournament (NEW SEASON 5)', 'viewer_count': 9456, 'started_at': '2020-08-05T18:16:46Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_tfue-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 25min'}, {'id': '2242425062438150125', 'user_id': '39724467', 'user_name': 'Swagg', 'game_id': '512710', 'type': 'live', 'title': '$100K TOURNEY + SEASON 5 | FaZe Swagg | !Scuf !Gfuel !BLM !tourney', 'viewer_count': 9231, 'started_at': '2020-08-05T16:31:17Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_swagg-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '2hr 11min'}, {'id': '5332008666833127998', 'user_id': '29829912', 'user_name': 'DrLupo', 'game_id': '512710', 'type': 'live', 'title': 'hard carried to tourney win @ 2 PM central', 'viewer_count': 8747, 'started_at': '2020-08-05T12:44:04Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_drlupo-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '5hr 58min'}, {'id': '2385007201', 'user_id': '81687332', 'user_name': 'cloakzy', 'game_id': '512710', 'type': 'live', 'title': 'TOURNEY W/ SYM AND HUSKERS. 5.3KD. GOING FOR 1000 WINS. SEASON 5 ', 'viewer_count': 8593, 'started_at': '2020-08-05T12:10:11Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_cloakzy-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '6hr 32min'}, {'id': '8793218428070733521', 'user_id': '15310631', 'user_name': 'Greekgodx', 'game_id': '21465', 'type': 'live', 'title': '@Greekgodx on Twitter', 'viewer_count': 4812, 'started_at': '2020-08-05T17:24:41Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_greekgodx-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 18min'}, {'id': '5338007399512641767', 'user_id': '38718052', 'user_name': 'Alinity', 'game_id': '509658', 'type': 'live', 'title': '‚ù§Ô∏è HI FRIEND! ', 'viewer_count': 3033, 'started_at': '2020-08-05T17:10:16Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_alinity-{width}x{height}.jpg', 'tag_ids': ['c2839af5-f1d2-46c4-8edc-1d0bfbd85070', '6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 32min'}, {'id': '4255317333837580053', 'user_id': '32140000', 'user_name': 'SypherPK', 'game_id': '512710', 'type': 'live', 'title': 'SEASON 5 IS HERE - $100 000 Warzone Tournament Later | @SypherPK | üëπ ', 'viewer_count': 2432, 'started_at': '2020-08-05T09:54:21Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_sypherpk-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '8hr 48min'}, {'id': '8050994238311066569', 'user_id': '133220545', 'user_name': 'Jay3', 'game_id': '488552', 'type': 'live', 'title': ';) Come here for a good time ;) | !yt !discord !corsair !IG !gfuel', 'viewer_count': 1875, 'started_at': '2020-08-05T15:44:16Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_jay3-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '8486f56b-8677-44f7-8004-000295391524', '353ab6ac-a0ee-404e-9bfa-217446b97718', 'e1a43486-eee5-4f36-9ee6-76e72af00180', '1eba3cfe-51cc-460a-8259-bc8bb987f904', 'ff56eeeb-99ed-4a60-93fc-0b3f05d8661e'], 'stream_duration': '2hr 58min'}, {'id': '1637038352453545139', 'user_id': '142199256', 'user_name': 'Slysssa', 'game_id': '138585', 'type': 'live', 'title': '‚ú® [12K] New !Tierlist Out! ‚ú®', 'viewer_count': 1272, 'started_at': '2020-08-05T15:57:54Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_slysssa-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '1eba3cfe-51cc-460a-8259-bc8bb987f904', '67259b26-ff83-444e-9d3c-faab390df16f', 'cea7bc0c-75a5-4446-8743-6db031b71550', 'b157e8d6-b7ba-49f4-836f-09886c072f1f'], 'stream_duration': '2hr 44min'}, {'id': '239551842', 'user_id': '31239503', 'user_name': 'ESL_CSGO', 'game_id': '32399', 'type': 'live', 'title': 'RERUN: North vs. GODSENT [Nuke] Map 3 - ESL One: Road to Rio - 7th/8th place Decider - EU', 'viewer_count': 1242, 'started_at': '2020-08-04T17:58:41Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_esl_csgo-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '36a89a80-4fcd-4b74-b3d2-2c6fd9b30c95'], 'stream_duration': '24hr 44min'}, {'id': '1595737514650134242', 'user_id': '120244187', 'user_name': 'Aydan', 'game_id': '512710', 'type': 'live', 'title': 'Finding S5 meta / Warming up for $100k tourney at 3est | !yt !twitter', 'viewer_count': 1075, 'started_at': '2020-08-05T16:04:14Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_aydan-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '2hr 38min'}, {'id': '6780718576851846946', 'user_id': '83080855', 'user_name': 'HarrisHeller', 'game_id': '509658', 'type': 'live', 'title': "üçë  Let's rank some Twitch streamers (or at least their streams) -- !StreamBeats üçë", 'viewer_count': 857, 'started_at': '2020-08-05T18:22:40Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_harrisheller-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 20min'}, {'id': '2385090337', 'user_id': '39158791', 'user_name': 'ProfessorBroman', 'game_id': '512710', 'type': 'live', 'title': 'SEASON FIVE HYPE TRAIN', 'viewer_count': 613, 'started_at': '2020-08-05T13:01:50Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_professorbroman-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '5hr 40min'}, {'id': '5642125246308866353', 'user_id': '415954300', 'user_name': 'NiceWigg', 'game_id': '514194', 'type': 'live', 'title': '!rogue Nothing but Rogue Company and positive vibes #sponsored #ad', 'viewer_count': 587, 'started_at': '2020-08-05T17:17:30Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_nicewigg-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 25min'}, {'id': '1968779444168479543', 'user_id': '51858842', 'user_name': 'AndyMilonakis', 'game_id': '509658', 'type': 'live', 'title': 'Quick PC Unboxing', 'viewer_count': 532, 'started_at': '2020-08-05T18:33:29Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_andymilonakis-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '77017b7b-6b98-4f0d-bd39-3ba96b66ec7a', 'cea7bc0c-75a5-4446-8743-6db031b71550', 'c38aeb6e-e8c7-452a-88e1-a3ed62c2e846', '67259b26-ff83-444e-9d3c-faab390df16f'], 'stream_duration': '0hr 9min'}, {'id': '6035760939494692266', 'user_id': '26261471', 'user_name': 'Asmongold', 'game_id': '18122', 'type': 'live', 'title': 'SHADOWLANDS NEWS--OPENING BOXES--GETTING GLADIATOR TODAY--WRAPPING UP YESTERDAYS DRAMA--MOUNT RUNS--MAIL MUNCHER TODAY', 'viewer_count': 56707, 'started_at': '2020-08-05T15:17:25Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_asmongold-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '3hr 25min'}, {'id': '247198802', 'user_id': '66983298', 'user_name': 'benjyfishy', 'game_id': '33214', 'type': 'live', 'title': 'trio cashcup | !twitter !youtube', 'viewer_count': 23164, 'started_at': '2020-08-05T15:05:26Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_benjyfishy-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '3hr 37min'}, {'id': '245741026', 'user_id': '133705618', 'user_name': 'Mongraal', 'game_id': '33214', 'type': 'live', 'title': 'Trio Cash Cup | Code Mongraal #EpicPartner', 'viewer_count': 21533, 'started_at': '2020-08-05T12:31:55Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_mongraal-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '6hr 10min'}, {'id': '824049043703224679', 'user_id': '44424631', 'user_name': 'NickEh30', 'game_id': '33214', 'type': 'live', 'title': 'Daily Trio Cash Cup | Code NickEh30 #EpicPartner', 'viewer_count': 11628, 'started_at': '2020-08-05T10:13:08Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_nickeh30-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', 'ff56eeeb-99ed-4a60-93fc-0b3f05d8661e', 'fd8f5e68-42d3-4544-a273-5fc92dabc568', '353ab6ac-a0ee-404e-9bfa-217446b97718', 'e90b5f6e-4c6e-4003-885b-4d0d5adeb580'], 'stream_duration': '8hr 29min'}, {'id': '4852033639956304906', 'user_id': '31688366', 'user_name': 'Symfuhny', 'game_id': '512710', 'type': 'live', 'title': 'New Season 5 + $100,000 Tourney [890+ Wins] [TTS ON] | !vid !tourney !record !loadout !format', 'viewer_count': 9266, 'started_at': '2020-08-05T10:25:58Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_symfuhny-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '8hr 16min'}, {'id': '6880144898885663785', 'user_id': '447330144', 'user_name': 'HealthyGamer_GG', 'game_id': '509658', 'type': 'live', 'title': 'Overanalyzing + Fear of Failure !support', 'viewer_count': 8757, 'started_at': '2020-08-05T17:06:38Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_healthygamer_gg-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 36min'}, {'id': '2385678801', 'user_id': '127550308', 'user_name': 'BotezLive', 'game_id': '509658', 'type': 'live', 'title': 'Early Stream Chess Sesh l !pogchamps !postmates', 'viewer_count': 5303, 'started_at': '2020-08-05T16:22:51Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_botezlive-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '67259b26-ff83-444e-9d3c-faab390df16f', 'cea7bc0c-75a5-4446-8743-6db031b71550', '1eba3cfe-51cc-460a-8259-bc8bb987f904'], 'stream_duration': '2hr 19min'}, {'id': '2386036337', 'user_id': '193270950', 'user_name': 'scoped', 'game_id': '33214', 'type': 'live', 'title': 'Daily Trio Cup', 'viewer_count': 5249, 'started_at': '2020-08-05T17:37:23Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_scoped-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 5min'}, {'id': '246675986', 'user_id': '66272442', 'user_name': 'Nikolarn', 'game_id': '514194', 'type': 'live', 'title': '‚úÖDROPS ENABLED!üîëPC/PS4/XBOX/SWITCHüîë!drop - https://NikoKeyboards.com/', 'viewer_count': 4382, 'started_at': '2020-08-05T14:10:54Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_nikolarn-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '4hr 31min'}, {'id': '3650916997207113924', 'user_id': '21130533', 'user_name': 'Nadeshot', 'game_id': '512710', 'type': 'live', 'title': '$100,000 WARZONE TOURNAMENT | SEASON 5 IS HERE @100Thieves', 'viewer_count': 4043, 'started_at': '2020-08-05T17:41:47Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_nadeshot-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 0min'}, {'id': '226500377460581183', 'user_id': '13240194', 'user_name': 'scump', 'game_id': '512710', 'type': 'live', 'title': 'team scrims ', 'viewer_count': 3871, 'started_at': '2020-08-05T17:57:05Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_scump-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 45min'}, {'id': '2385588417', 'user_id': '69906737', 'user_name': 'chocoTaco', 'game_id': '512980', 'type': 'live', 'title': "TSM chocoTaco || don't fall, guy", 'viewer_count': 3300, 'started_at': '2020-08-05T16:00:48Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_chocotaco-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '2hr 41min'}, {'id': '246363026', 'user_id': '128149102', 'user_name': 'ShivFPS', 'game_id': '511224', 'type': 'live', 'title': 'LG ShivFPS | Pubs and Ranked | !yt !twitter !ig !gfuel', 'viewer_count': 2973, 'started_at': '2020-08-05T13:38:53Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_shivfps-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '5hr 3min'}, {'id': '2385427329', 'user_id': '181224914', 'user_name': 'NateHill', 'game_id': '33214', 'type': 'live', 'title': 'Hour late trio cup | !positivity !dips', 'viewer_count': 2837, 'started_at': '2020-08-05T15:14:27Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_natehill-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '3hr 28min'}, {'id': '7674089860005171245', 'user_id': '224145872', 'user_name': 'JordanFisher', 'game_id': '516575', 'type': 'live', 'title': 'SEASON 2!!! Playing with Ninjjjj - 37 sec delay', 'viewer_count': 2201, 'started_at': '2020-08-05T15:37:42Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_jordanfisher-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '3hr 5min'}, {'id': '2385460177', 'user_id': '23220337', 'user_name': 'Emongg', 'game_id': '488552', 'type': 'live', 'title': 'Wednesday  :) - Live every day at 12pm Eastern :) - !postmates !youtube !minecraft', 'viewer_count': 1939, 'started_at': '2020-08-05T15:24:46Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_emongg-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '65635721-439d-4919-9897-052f9c7f86a0'], 'stream_duration': '3hr 17min'}, {'id': '39246789728', 'user_id': '90020006', 'user_name': 'TSM_Viss', 'game_id': '493057', 'type': 'live', 'title': 'TSM Viss on PUBG w/ Halifax !Partie // Twitter: @TSMViss Insta: @TSM_Viss', 'viewer_count': 1221, 'started_at': '2020-08-05T14:40:23Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_tsm_viss-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '4hr 2min'}, {'id': '6253620425037242946', 'user_id': '186394988', 'user_name': 'AverageAden', 'game_id': '514194', 'type': 'live', 'title': '‚úÖ!DROPS ENABLED‚úÖ | NASTIEST Phantom Snipes !codes', 'viewer_count': 757, 'started_at': '2020-08-04T23:03:40Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_averageaden-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '19hr 39min'}, {'id': '247473106', 'user_id': '415068073', 'user_name': 'FK_ORCA', 'game_id': '516575', 'type': 'live', 'title': 'Valorant new update!', 'viewer_count': 714, 'started_at': '2020-08-05T15:34:25Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_fk_orca-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '3hr 8min'}, {'id': '690280948083389716', 'user_id': '78556622', 'user_name': 'justfoxii', 'game_id': '33214', 'type': 'live', 'title': 'sailor moon vibes', 'viewer_count': 618, 'started_at': '2020-08-05T13:39:18Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_justfoxii-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '5hr 3min'}, {'id': '3899349440564859627', 'user_id': '22916751', 'user_name': 'Bajheera', 'game_id': '18122', 'type': 'live', 'title': '3000+ Rank 1 Warrior - Alt Warrior Grind & Shadowlands Beta Today?', 'viewer_count': 231, 'started_at': '2020-08-05T18:02:02Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_bajheera-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '07a1b526-3725-4ba5-8c53-efaad4941fb9', 'cea7bc0c-75a5-4446-8743-6db031b71550', '1eba3cfe-51cc-460a-8259-bc8bb987f904', '62bc5436-6f91-446d-9651-da008da4e4bb'], 'stream_duration': '0hr 40min'}, {'id': '3229183698551424171', 'user_id': '135262775', 'user_name': 'TheGodlyNoob', 'game_id': '488190', 'type': 'live', 'title': 'WSOP TODAY !poker ~ Sub free with !Prime', 'viewer_count': 203, 'started_at': '2020-08-05T17:03:37Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_thegodlynoob-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 39min'}, {'id': '7326085792931126453', 'user_id': '410330426', 'user_name': 'TheRealestRai', 'game_id': '509658', 'type': 'live', 'title': 'FINAL BOSS? FURI 420 !game', 'viewer_count': 76, 'started_at': '2020-08-05T16:59:48Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_therealestrai-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 42min'}, {'id': '5541039988788890161', 'user_id': '196413243', 'user_name': 'jennysmiles', 'game_id': '509658', 'type': 'live', 'title': 'NEW COD SEASON AHHHH!!!', 'viewer_count': 40, 'started_at': '2020-08-05T18:27:12Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_jennysmiles-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 15min'}, {'id': '39246783488', 'user_id': '57717183', 'user_name': 'Mendo', 'game_id': '516575', 'type': 'live', 'title': 'KILLJOY GAMER - Liquid @Mendo', 'viewer_count': 3962, 'started_at': '2020-08-05T13:06:10Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_mendo-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '5hr 36min'}, {'id': '245323410', 'user_id': '51929371', 'user_name': 'mL7support', 'game_id': '488552', 'type': 'live', 'title': '4k to 4.5K SR on SUPPORT day 3 | NEW !HL', 'viewer_count': 2888, 'started_at': '2020-08-05T11:41:26Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_ml7support-{width}x{height}.jpg', 'tag_ids': ['4740b6f8-d83f-420c-9586-be34e03c3efb', '6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '7hr 1min'}, {'id': '2912244307366798497', 'user_id': '114856888', 'user_name': 'VarsityGaming', 'game_id': '460630', 'type': 'live', 'title': 'if you cheat in the new event, you a bum - !charm !prime', 'viewer_count': 1611, 'started_at': '2020-08-05T15:56:42Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_varsitygaming-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', 'b157e8d6-b7ba-49f4-836f-09886c072f1f'], 'stream_duration': '2hr 46min'}, {'id': '2385853697', 'user_id': '135246610', 'user_name': 'ChipSa', 'game_id': '488552', 'type': 'live', 'title': 'Philly Fusion DPS, ü¶Ä Genji is dead ü¶Ä', 'viewer_count': 1499, 'started_at': '2020-08-05T17:01:27Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_chipsa-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 41min'}, {'id': '248647810', 'user_id': '16764225', 'user_name': 'Syndicate', 'game_id': '512710', 'type': 'live', 'title': 'Season 5! - Road to 200 Wins #WarzoneWednesday', 'viewer_count': 1252, 'started_at': '2020-08-05T17:23:29Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_syndicate-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 19min'}, {'id': '6336259520150953227', 'user_id': '165794626', 'user_name': 'zedar_yt', 'game_id': '33214', 'type': 'live', 'title': 'üèÜPRIZE FASHION SHOWSüí∞ HIDE & SEEK AND SCRIMS & CAR RACE & MORE! Skin Competition & FORTNITE LIVE WIN MONEY & V-BUCKS | Code: Zedar #ad', 'viewer_count': 430, 'started_at': '2020-08-05T18:01:36Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_zedar_yt-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '1eba3cfe-51cc-460a-8259-bc8bb987f904', 'fd8f5e68-42d3-4544-a273-5fc92dabc568', 'ff56eeeb-99ed-4a60-93fc-0b3f05d8661e', '353ab6ac-a0ee-404e-9bfa-217446b97718', 'ac763b17-7bea-4632-9eb4-d106689ff409'], 'stream_duration': '0hr 41min'}, {'id': '4192399152111724299', 'user_id': '54706574', 'user_name': 'JoshOG', 'game_id': '32982', 'type': 'live', 'title': 'Mario Le-Pipe ( NoPixel )~~ SIGNED EXCLUSIVELY WITH TWITCH!!!!', 'viewer_count': 349, 'started_at': '2020-08-05T18:29:55Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_joshog-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 12min'}, {'id': '248372098', 'user_id': '74634650', 'user_name': 'RAGTAGG', 'game_id': '512980', 'type': 'live', 'title': 'Fallguys and Apex and hype mongering', 'viewer_count': 274, 'started_at': '2020-08-05T17:00:34Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_ragtagg-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '69318d09-f132-4853-b4b6-09a0580f7092', 'adb55316-f1ab-4f81-9ff5-17da7719d0ee', 'a005b174-b20e-46b1-8679-4589fef81c8e'], 'stream_duration': '1hr 42min'}, {'id': '7510477601843734164', 'user_id': '27645199', 'user_name': 'Vale', 'game_id': '488552', 'type': 'live', 'title': '<insert good title here>', 'viewer_count': 158, 'started_at': '2020-08-05T15:59:49Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_vale-{width}x{height}.jpg', 'tag_ids': ['67259b26-ff83-444e-9d3c-faab390df16f', '1eba3cfe-51cc-460a-8259-bc8bb987f904', 'e1a43486-eee5-4f36-9ee6-76e72af00180', '6ea6bca4-4712-4ab9-a906-e3336a9d8039', '8bbdb07d-df18-4f82-a928-04a9003e9a7e'], 'stream_duration': '2hr 42min'}, {'id': '247046498', 'user_id': '82641738', 'user_name': 'Tilly', 'game_id': '488552', 'type': 'live', 'title': 'Friendly fool making the most of this Wednesday ~', 'viewer_count': 113, 'started_at': '2020-08-05T14:50:36Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_tilly-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '3hr 52min'}, {'id': '248757922', 'user_id': '104919208', 'user_name': 'Sooshikitty', 'game_id': '488552', 'type': 'live', 'title': 'GM Peak Support - Wednesday is the peak of the week', 'viewer_count': 110, 'started_at': '2020-08-05T17:32:57Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_sooshikitty-{width}x{height}.jpg', 'tag_ids': ['ace85ca5-bec4-4820-b941-ff92dbb8c42f', '6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '1hr 9min'}, {'id': '4033407495684113311', 'user_id': '43338097', 'user_name': 'Qilin', 'game_id': '488552', 'type': 'live', 'title': '[Eng | PC] widepeeoHappy', 'viewer_count': 70, 'started_at': '2020-08-05T18:23:52Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_qilin-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '0hr 18min'}, {'id': '245016194', 'user_id': '114582774', 'user_name': 'Excidx', 'game_id': '488552', 'type': 'live', 'title': 'Not lucioball !social !Design', 'viewer_count': 45, 'started_at': '2020-08-05T11:00:45Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_excidx-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039'], 'stream_duration': '7hr 42min'}, {'id': '248427330', 'user_id': '249949357', 'user_name': 'Ghosty_iris', 'game_id': '488552', 'type': 'live', 'title': "I'm almost plat! Mercy/Moira main <3", 'viewer_count': 37, 'started_at': '2020-08-05T17:04:20Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_ghosty_iris-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '1eba3cfe-51cc-460a-8259-bc8bb987f904', 'dcf598ca-b5de-47d4-af33-ecabe9eaeee1'], 'stream_duration': '1hr 38min'}, {'id': '249583890', 'user_id': '88342252', 'user_name': 'beautyxskillz', 'game_id': '511224', 'type': 'live', 'title': 'baepex‚ù§Ô∏è/ !instagram', 'viewer_count': 20, 'started_at': '2020-08-05T18:36:43Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_beautyxskillz-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '1eba3cfe-51cc-460a-8259-bc8bb987f904', 'fd8f5e68-42d3-4544-a273-5fc92dabc568'], 'stream_duration': '0hr 6min'}, {'id': '2385846241', 'user_id': '247289633', 'user_name': 'disneyfreshy', 'game_id': '33214', 'type': 'live', 'title': 'The new gta update sucks', 'viewer_count': 10, 'started_at': '2020-08-05T17:00:11Z', 'language': 'en', 'thumbnail_url': 'https://static-cdn.jtvnw.net/previews-ttv/live_user_disneyfreshy-{width}x{height}.jpg', 'tag_ids': ['6ea6bca4-4712-4ab9-a906-e3336a9d8039', '1eba3cfe-51cc-460a-8259-bc8bb987f904'], 'stream_duration': '1hr 42min'}]
    known_uid = '15564828'
    known_uid_list = [stream.get('user_id') for stream in full_test_list]
    test_init_time = datetime.now(utc)
    twitch_time_fmt = '%Y-%m-%dT%H:%M:%SZ'  # '2020-08-05T01:09:17Z' -> denotes Aug 5th 2020, 1:09:17 AM (UTC)

    def setUp(self):
        pass

    def tearDown(self):
        pass

    def test_dictify_list(self):
        self.assertTrue(isinstance(LiveStreams.dictify_list(self.full_test_list), dict),
                        'Dict was not produced from full test list.')
        self.assertTrue(isinstance(LiveStreams.dictify_list([]), dict),
                        'Dict was not produced from empty test list.')
        self.assertTrue((LiveStreams.dictify_list([]) == {}),
                        'Empty dict was not produced from empty test list.')
        self.assertFalse(LiveStreams.dictify_list([]) is None,
                         'Expected empty dict but got "None" instead.')
        self.assertTrue(len(self.known_uid_list) == len(LiveStreams.dictify_list(self.full_test_list)),
                        'The known test list and dictified version were different lengths.')
        self.assertTrue(set(self.known_uid_list) == set(LiveStreams.dictify_list(self.full_test_list).keys()),
                        'A uid was omitted from the resulting dictionary keys.')

    def test_parse_duration(self, sample_time: str = None, base_time: datetime = None):
        if sample_time and base_time:
            parsed_result = LiveStreams.parse_duration(sample_time, base_time)
            self.assertTrue('stream_duration' in parsed_result,
                            'Expected "stream_duration" as key in parsed result')
            parsed_value_split = parsed_result['stream_duration'].split(' ')    # value has example form: "1hr 1min"
            self.assertTrue('hr' == parsed_value_split[0][-2:],
                            'Expected "hr" in value of parsed result.')
            self.assertTrue('min' == parsed_value_split[1][-3:],
                            'Expected "min" in value parsed result.')
            return

        str_times = {
            'base':       '2020-08-05T08:09:17Z',
            'day ago':    '2020-08-04T08:09:17Z',
            'hr ago':     '2020-08-05T07:09:17Z',
            'min ago':    '2020-08-05T08:08:17Z',
            'hr min ago': '2020-08-05T07:08:17Z'}

        parsed_base_dt = dt_parse(str_times['base'])
        self.assertTrue(isinstance(LiveStreams.parse_duration(str_times['base'], parsed_base_dt), dict),
                        'Expected a dict result from parse duration.')
        self.assertTrue('stream_duration' in LiveStreams.parse_duration(str_times['base'], parsed_base_dt),
                        'Expected to find "stream_duration" as key.')
        self.assertTrue(LiveStreams.parse_duration(str_times['base'], parsed_base_dt)['stream_duration'] == '0hr 0min',
                        'Expected no time difference between str_base_time and datetime(base_time)')
        self.assertTrue(LiveStreams.parse_duration(str_times['day ago'], parsed_base_dt)['stream_duration'] == '24hr 0min',
                        'Expected duration from day ago to yield "24hr 0min"')
        self.assertTrue(LiveStreams.parse_duration(str_times['hr ago'], parsed_base_dt)['stream_duration'] == '1hr 0min',
                        'Expected duration from hour ago to yield "1hr 0min"')
        self.assertTrue(LiveStreams.parse_duration(str_times['min ago'], parsed_base_dt)['stream_duration'] == '0hr 1min',
                        'Expected duration from min ago to yield "0hr 1min"')
        self.assertTrue(LiveStreams.parse_duration(str_times['hr min ago'], parsed_base_dt)['stream_duration'] == '1hr 1min',
                        'Expected duration from hr + min ago to yield "1hr 1min"')

    def test_list_apply_stream_duration(self):
        self.fail()

    def test_filter_language(self):
        self.fail()

    def test_add_uid_tot_followers(self):
        self.fail()

    def test_update_from_list(self):
        self.fail()
